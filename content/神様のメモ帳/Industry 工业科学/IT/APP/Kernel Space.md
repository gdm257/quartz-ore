---
tags:
- Label/Article/Industry-工业科学/IT/APP/OS/Linux
---

## Kernel Space

参考

[用户态与内核态 -- 帮你解惑，直达本质 - 掘金](https://juejin.cn/post/6920621924791894023)

[【性能】关于Linux进程的用户态、内核态和内核线程 - 简书](https://www.jianshu.com/p/701c47139781)

[用户级线程和内核级线程，你分得清吗？ - 掘金](https://juejin.cn/post/6844903962504593421)

[一文理解JVM线程属于用户态还是内核态 - 腾讯云开发者社区-腾讯云](https://cloud.tencent.com/developer/article/1839593)





Inter 把 CPU 指令操作的权限划为4级：

    ring 0
    ring 1
    ring 2
    ring 3

不同级别的权限可以使用的 CPU 指令是有限制的。其中 ring 0 权限最高，可以使用所有 CPU 指令，ring 3 权限最低，仅能使用常规 CPU 指令，这个级别的权限不能使用访问硬件资源的指令，比如 IO 读写、网卡访问、申请内存都不行，都没有权限

Linux 系统内核采用了：ring 0 和 ring 3 这2个权限

    ring 0 被叫做 内核态，完全在 操作系统内核 中运行，由专门的 内核线程 在 CPU 中执行其任务
    ring 3 被叫做 用户态，在 应用程序 中运行，由 用户线程 在 CPU 中执行其任务


「内核态」与「用户态」是个充满人为需求的设计，Kernal 本质是软件.

也就是说，所谓的用户态、内核态实际上是处理器的一种状态，而不是程序的状态。我们通过设置该状态字，可以将CPU设置为内核态、用户态或者其他的子态（有的CPU有更多种子态）。一个程序运行时，CPU是什么态，这个程序就运行在什么态。

但是 OS 对程序能让 CPU 运行在什么态作出了限制。用户态的进程或线程不能运行 ring 0 指令，而是通过发送 system call，让 OS Kernal 代为执行 ring 0 指令，然后将结果返回给用户态进程或线程。也就是说，用户态进程或线程不可能以内核态运行，凡是需要运行高权限指令，都要 trap 陷入到内核，切换到内核进程来执行。