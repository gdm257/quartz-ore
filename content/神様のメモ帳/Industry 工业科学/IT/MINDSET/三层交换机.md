---
tags:
- Label/Industry-工业科学/IT/TCP_IP/Protocol/3-互联网层-网络层
---

三层交换机不是路由器，反之亦然，二者是不同产品。路由器主要依靠 CPU 来实现各种功能，三层交换机通过专门的芯片进行转发。三层交换机是二层交换机 + 路由模块，路由器是三层交换机 + NAT QoS ACL PBR 等高级功能，这些高级功能一般的三层交换机难以实现，要实现其成本会超过路由器，至少对消费级不友好。

三层交换机の工作原理：报文到达二层数据链路层时，解析数据帧，若是目标 MAC 能匹配上转发表，则直接转发，此时相当于一台纯粹的二层交换机；若是目标 MAC 无法匹配，送到第三层的路由模块（路由模块相当于二层交换机的默认网关），解析，若是同一网段，或目标 IP 能匹配上路由表，则按路由表转发；若是不能，路由模块进行一次泛洪得到下一跳的 MAC 地址，转发到下一跳，即一次路由，多次转发。顺便说下，转发表是通过路由表得到的，所以理论上路由表有的转发表可以直接处理，不用经过第三层。

1. 接受到外部数据，解析数据帧
2. 登记（自学习）
3. 转发表能匹配目标 MAC，二层交换机直接转发
4. 转发表不能匹配目标 MAC，交给路由模块处理
5. 路由表能匹配目标 IP，直接转发
6. 路由表不能匹配目标 IP，泛洪得到下一跳的 MAC，转发到下一跳